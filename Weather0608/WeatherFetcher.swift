//
//  WeatherFetcher.swift
//  Weather0608
//
//  Created by taekkim on 2023/06/08.
//

import Foundation

@MainActor
class WeatherFetcher: ObservableObject {
    @Published var weatherModel: WeatherModel = WeatherFetcher.dummies

    func fetchWeather() async throws {
        guard let url = URL(string: "https://api.openweathermap.org/data/2.5/forecast?lat=44.34&lon=10.99&appid=0050a46930ff1d959ebc682f59823c40") else { return }
        let (data, _) = try await URLSession.shared.data(from: url)
        let weatherModel: WeatherModel = try JSONDecoder().decode(WeatherModel.self, from: data)
        self.weatherModel = weatherModel
    }
}

extension WeatherFetcher {
    static let dummies: WeatherModel = WeatherModel(list: [
        Weather0608.WeatherList(weather: [Weather0608.Weather(id: 801, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.fewClouds, icon: "02n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 801, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.fewClouds, icon: "02d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 803, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.brokenClouds, icon: "04n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 804, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.overcastClouds, icon: "04n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 804, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.overcastClouds, icon: "04d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 801, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.fewClouds, icon: "02d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 803, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.brokenClouds, icon: "04d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 804, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.overcastClouds, icon: "04n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 804, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.overcastClouds, icon: "04n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 804, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.overcastClouds, icon: "04d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 803, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.brokenClouds, icon: "04n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 802, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.scatteredClouds, icon: "03n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 803, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.brokenClouds, icon: "04n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 803, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.brokenClouds, icon: "04d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 800, main: Weather0608.MainEnum.clear, description: Weather0608.Description.clearSky, icon: "01d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 800, main: Weather0608.MainEnum.clear, description: Weather0608.Description.clearSky, icon: "01d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 800, main: Weather0608.MainEnum.clear, description: Weather0608.Description.clearSky, icon: "01d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 500, main: Weather0608.MainEnum.rain, description: Weather0608.Description.lightRain, icon: "10d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 804, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.overcastClouds, icon: "04d")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 802, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.scatteredClouds, icon: "03n")]), Weather0608.WeatherList(weather: [Weather0608.Weather(id: 802, main: Weather0608.MainEnum.clouds, description: Weather0608.Description.scatteredClouds, icon: "03n")])])
}
